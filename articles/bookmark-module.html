<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bookmark Modules Example • shinystate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bookmark Modules Example">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinystate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/shinystate.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/bookmark-module.html">Bookmark Modules Example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rpodcast/shinystate/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bookmark Modules Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rpodcast/shinystate/blob/v0.1.0/vignettes/bookmark-module.Rmd" class="external-link"><code>vignettes/bookmark-module.Rmd</code></a></small>
      <div class="d-none name"><code>bookmark-module.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>shinystate</code> package was greatly inspired by an <a href="https://github.com/jcheng5/rpharma-demo" class="external-link">example application</a>
created by Joe Cheng (creator of Shiny) to accompany his keynote
presentation at the 2018 <a href="https://rinpharma.com/" class="external-link">R/Pharma
conference</a>. Among other notable features as documented in the GitHub
repository <a href="https://github.com/jcheng5/rpharma-demo/blob/master/README.md" class="external-link">README</a>,
the application provided an alternative user interface powered by Shiny
modules to save and restore bookmarkable state. The following example is
an adaptation of the original version to utilize <code>shinystate</code>
to manage the bookmarkable state features.</p>
</div>
<div class="section level2">
<h2 id="how-to-run-application">How to Run Application<a class="anchor" aria-label="anchor" href="#how-to-run-application"></a>
</h2>
<p>The application source code is included in the ‘shinystate’ package
and it can be launched with the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpodcast.github.io/shinystate/">shinystate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/runExample.html" class="external-link">runExample</a></span><span class="op">(</span><span class="st">"bookmark_module"</span>, package <span class="op">=</span> <span class="st">"shinystate"</span><span class="op">)</span></span></code></pre></div>
<p>If you are viewing this package vignette in a web browser, the
application can also be viewed using the Shinylive service:</p>
<p><a href="https://shinylive.io/r/app/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAdzgCMAnRRASwgGdSoAbbgCgDk7ABZsAnpyjkBuAAQM4qIu1kBeWQUHDSpVO0QB6AwyUATAlE4YGAWgCuEFgDc4DdnAym4TmbIHbdfSMFJWsbaksYDCIGAHMBAEoEgB0IAGIBWQBRJx47KThZKAhZOAAPVAV2dhYSWTYi2QAzKuFSiCcWBhJ4MlSM-syAGRYAa0LvHgB9UhZTMTk6O1JZahZSNtMWJqbXChWvJqg7blJ2DFkAITFZQ+PTuTZOOChTWSIm+QdHCFjB+pKG0KFl4riE7U63QgvVIjxWDAcKgaUGarQhXR6+ww-wAAuUlAxSKlJtwpgRuC8SgAeGzNBwEWYkPj4hhyChONSybgsTh8BJsiDk5Sc8mUqbsvkJWQgVKyUq5UmzebMiqsiECoXsFIQAC+qX+AGEFAVGqLiuioTDBobjeQVCiIHBqBbMWRVsJlIVUFAFG6ebIgbJYtwiHQeC7oVjcfiYkTBRTiuKOrIaXTBYyIHzpbLZI7qBgJd7fSt1MHQzwJUlUnqIP8AFJEBog7hIshERqoFioODcx3E1VTTvd3uFVNNekZvgYadyDDczic+ekKfTpLZkqlVUqVNznlxuXbWR8Cm-DYqypatTqAAMUplG7lClIdgYmYAcgBVIZDbVyms5llt1pBhuGKWJmCaUCdAoc83G1ACtxTWkADEWFOVw+DfOBYgKPgeQwCATm4flNwveCN0PY8KFiM9AKlVQbzvHNHzgZ9X0wr8fxzf8NywOBTDsAg4D4Zi0wZWpM3gGAiDZVUmIfOVSIYPgAEIVKk9sAFIAD5NNkNSWV-RSdVwUSuDQ2D2DkGwAEZ+VEwDgGAGyAF0XJzbUeJaFgKFMbgxBmFh4CQsTJ1IeS5RWVNugcUwplMXDYVkZIwHcYgIFMdgUqMiAiGdaKiFi+LcIAZQkDBZngPk5BStKSEy7L9Q3KA6HYYqAq2HYQpa9g+ASsQ+Fy6gpVpfq+HCoyoFiUdaSG2RaTjHMeqmKaZqKVq+FWozxzYtbVv09RltWnMtgYELth7dw+B2l84BqsAWiIGBczylL7qmohGtrDcmhiGApCmBRuBC8d0wkvgal+E4fTkVBuBfcN1G9Z5rwhthYmhtVauyiLFLKbrzjYchpuUmKMvGoK4CmE8aOETbWpW6a5EhjHQIYJIjLldhKiJpoRLATS3k0lRhbe2QykeXYW2E-GGNkGzmfRzHYfhhgeBI06jJ4g8pau0Sjumq9ZDqjLetvUyFJSt9XrwUSLulkSFLlA3R1kGA2GWOBersi3FMU36GH+0hAZ7fmTdMbLfb9+pdeE0S-ZdlNZA9F9vfsp3-b+gGgf593CPISP48U+29YzhOGf2qlk8Ktw+AANnT6Po4DoOQ-4FKU4YQuy8UtJZCGL2VA2c0ACYABZq9TuRijeASGHRgNhEKdhYGBCsMp9W4oDEIu-ZLuOe-LtrK63iQ+Ds2QADJ1ra-r4u2T45evKOm79zgGCaSrhKSlLNIASUQJpAAsoAkqshNKoG7q-aO+9HbQKbonKu-VeoAGZG7wLfqQD+X9xr3U0iif+gCQGaTARAqBGDFLv0-pTXByUBYAE0DCaRgEwoWADgGgPAZAsAnN4G8KbvwxSgjeFGU8qkOgRAiCjH+gwUYUxpIJVJCvFwUw7AsBBhOcGcxcYcBCm+EqeFTDkUilNEYvJ9biRICMCAoxBq9Vqh6agUxlFUwUTwSOdCSpQBcMbQeEkvpyjEd9CRUiZFyLcaSEMrxVHqLHJopk2j1xyl0amfRhjjEBlMXuOBikoCWIgNY2xHAw6OOpkQaJESPEpT4pwGIy8-EkACbIIJ4jJHSJ9HIqJcU1EaLBgkoxSTcxAVkGk7ROYuCxDMcuUSaiADyyxUDLDsWHbx-FnENI4DjDy1YmohPabI+RRA3hxL6ZmNgiykqFV0MsZmGzmakBiFtQZKTaTuGqBJAAJJsjcbyagkHip8aKLxxIuD4PeTBjzpofOmsHX5ElepawyVci5HyXFxThSQNqcM8lwA9NwLwZ0gUZVcB+P+YLRIABEAAqzAEpcCpS1Ck8zrnLgxRAL59jUqrPRRstqXA6AUi2RuHUSKFnLFRdy9Z7zMUzEZWtalzBfQEopVIKADKBXCXBYpBQABHCGGyAWSkpTSxAdLVUapyW-A1pg+boL9l7Cw3ZOTIQAIJDBKlkF+lCexwHyZyWq6NBVgFEoipqXMDUEA9CwISIVjQgs1aJXV+rpUQENVWBSSbznirRVKv5HBZUasBnlNq7gKQMn4rw2JtIs2kAlS4HlKa+VyqLdQEtPry0RwUi+YGqY2VpuACwe63aUruQzaxF8mZu2hu+nKUM7gGAuByPsPCEAUVVAeQoOQWqWJ6r7ZGxsQkjUKVqWrKF666nJrzWSKNh701-gySIcQzB3CkEuG0sJWQyjkjsF4PgmhRIOLys41ZhzFFvQA6lUpXTQPuNtpbLlKjoDwHA-BlxKG-a1QjTeuA6HFIpXPQoFKHkkWtVcIulwZAV0opEEB6DESt2iRo9QIBRyeB8AiRSlgPAiCxEtZQlgAAvQo6gUplG4Lh+1lgxAGhDO4TkVKsAfk9UXWYpAKT+rADUjd9SU0SczkQcgZ11ATKmXxv2ETLjLAeZmFKBpihCXEzwr1Cd8mWZ0EyNlHL+YEZw05uhWm6li3JJYFQImwB0FIBAGwPMZE7x4UXO1ikTPZN3rIOZYrWUbK87VSVbKsWgSEniglQqBEhunTmOdZG4BLsozW1FpSXEwe4Ax49jiWOKPY6x7gnHuO8aLi8dg0nZPCdkAppTzmAzlFIH-VdSzPPFJy4h1eVSwAAHFnCFA2P6NljQkO+cS3KX6BnXCcmS+YnuFmrNMls-Zns5CEGuau5mebnK0N+ZSl4lwQXQLVA0xFqLMWfRxeEWV7iJH53keXXVlxjxYi5QUDN9Y8nFOesGZFBg0mpCRrM2jmBnxVI8ipQiDYA1ocgb22ubdr9amoH5gABQTHJ7mvrtg3BRHssJuZlvxZ7jqUo0tcdNwUNJFw7W2OCIhaeuAqLoB6A9NMw+3qU3yNYq8VVi4UuK7fuT1enIydLfgBN6BX9JAwFQJyMq5wcES+jjbwJqWuaOOtrMJo0apDgwd3hsAJUNnG0EkJao45eA3DRURxXNuaxNxMv1hg3QjOhXBnAXGTcmPO+2G7ycnv0pbAzEAweq1mQHejqQMQTqwuuDj2H6BgjI9CLBzsiArv0IMBib0-J6TnnDNGUYsNmTJma79lsJwhjOQLYemhQzZISDmUdF3HhiW8kZjc9Z5ZgGnFN8n1sXrUx-srZdaYN4G-XBNJaY3ifrhQNt8nDWuQyKbm+JTXIM14o5Kd5Ci93vL632hI6Z+79v7-1IMgMj8W8t8QxYgd9IsxYUpXg4oQDIDax59e94DXcexMoQolw+Qcx-pxg+JF8NtLg2Athfh+YUCfJ8UsoecKsIBv99lbFQZ29JByBk9jYuByAPkFQ7AvYPkyC0Cpg9thkBDrpz8W9UCKDysNwSAAsFBrp4lns2Ck9cdeD8V+DV5hkmDpdODuDlC4oBDRIA4jwxDTA9sARmgRCpgjDVD4BLwqdnYD9UJm9hC0CKdRJa8RVe9KsF1qsKNlxodSl4CwCeMECWsE5cg0Jm0jDBC1DmQFQyQExMxn8WRJQpQdJNIi4wx3Bn1WJOo+YhCdCtQMlHc8oxd+AOMuNwCcdVN1Mwt99D8RCUMi41YtgiBl9MVV9x9m8LDyCI53swBUI0CAx2wQCxZvEoBwjC1Ij04i4jtDNTsslztoFLt3MbMwA7NBQ7snNUt8CSBWjMwx9YCujOjd9ejaizDm8mk-YREJDZ1SMvCatfDZta0Dj4D-sQjcl7CRCqNxUdDeFhciBRcussDhUMlYCHDZiTl28jCKdcc5gQpkZyBUYUp4CpgxYoTV5CizjwTaQCBbQ4AwSMIi4zVOQSQ4jKQ+pVUX9KhJQnI0T4A3IJtYT1BiltEJtaSRs2SQ1e9DsFA4AhM8D40AA1PIYSG-eoHvGdYuDgVwUgUlHHeEuAREsANIMWMfeA9KGfY-efCbFKOgOAAOarDKPTOUPuKlWZClWZRAUodgR1ZebsAgcojQYQH0RfVwVsMw5w5bDOEAj5NRTkiUw7EQj5GtP+Y5atTtP2fImk7ovbNyFMMceo4VXvONWYUFKnKoE4YOFkEKRI1UIEu2fHGmM8fI+iRiQXeQcddidM04Sk9mVwrk2QPuVbKQJeM6Owc3HgYGEApSXlByRCVMUCdAfyQaaI4suQBgycaE2wzEk7eMzoyIpyGM0dJufGVMSwDAQbGACRfgaEtIG1Bc1eNyIuIsWAc6R4qM5vJyFKYMnotyQ8jObPGskGEQy8jowzT9SoEdFyPgWWcWWGZ056JGf8wRSiFSfCQiXgP9eqGsynVLKszM1UOM2kJItSOCx81I6c5SNSB8wyGvIuNgToGoC1Xhdw-08s9gDMms+vXUJqHEl4cgfEwlWkcc8GM1R4UwMc6M9EwZD8dwPPDYI5fmWigoBir6HiIS+ikQjASNZ08tRihPJkVisUjij0+AXGTAmZdRYzKbGbC5QxZS-FPbe6e7DC98+PZipkCWWQY8mAFgnWI8FSCAATaS5SaymCnuT8b8IuPnS6QoKcuUJI2IEIfgNSayuQNSSylgOHOpKSywEbMbVHV3MofiZHJTO9aOWvP8bZai76cSvEySwieAeeAgK-Fi1VNi-S4wrirVdSrtTS42bkAlHSpZPC9i6Yziw3IuPOTkPOckrgIvf6H8ga3qqAIvLQzkNWX4YSM1ERL1EA0yzkcyzMSy1yss5ClSfGbSdQEK-85yFyK+fSdalMLalSay4AEeFyYirKsS3EhijAImbCGc7Em6-KuwQq6NGi565vDAI4BkGIEqhSsqpS90gyqqnMGtA0afboHtatAs6iM8CkFwFsYatcbSWQBuXHUtX1abR4vS4Gyqw3LkbwS6ZGuQZyl05Sc2N2DMrsao0bFHLWfnOTKnSNX1UYCRMoVbGKVAJq3w9ivGwywmxG3qaarWXvGqv2HpdQcGyGogZrfQkQ+a9QRa78v8tWGyssyiQsumFap+WyxSDyoYLyxm3y1LNa-GTSNgPSbatW3ChSWvU-XK26unWZEqP+AADSiieroryq+oKtcHeqlLLWDlyDcFbwhOvwGS1ReRGQMTGQ3DOwVwlpYGZV0rHxDral9KQI3FP0xoZCmHTv+rOUeNvwy1uUf1kHTqfwpMMjf17Sy2+Qqwyw4J9AzqrXLOJQYFlKpxaDgF5LgH5JTLgCFPhhFOLroXTouN8SDp5vaInt6KFPnjlSHnbC2G5lAjizkHTuqiptOBprivptEjSBZoIDZqIA5q5pnrTpbpWwXq4w1UoLkCEOmtuSDuSqZOiJFqopzGTI23JQUk1rhrpjq3TpLNkFvDLJzKpOIuNtWtzLUkgeUhSN0inqxtUjUg3N6mAZbo5jrOBIb1SHIpgBkUEyph6XDq0UjpzGju7yMgTr43SxZXaMIeIaExiRK2aXwY4FepYdcSOULq+MuVLofzzU3pbqrq4GgsGTv1rWYZ9BIbDuAl8hJTJSp2jo-1IroaLlzuxt0tSzH0CsKlQB32ByNzoU5sMdkDoA3tS33WjS9k5C3qLzlBgGprhn3qUwSwm20Znr0c5SIG7DVgzGMow2924aB3eACfd0aTg2gUAPgGKGgNSlesSeIAcCJB5wES8fbR0eap7n2NiECuwgKGCa9xKjCYxwruFKNMUlsYDwcZbuqlSxcd3rcZSqyASz9PvSTOBUHr-r9lQqzNTAQaBL3lhtPCAceOhS5uMalFRvAanIGYQtTDWsWcqHAWQYMbbOMbQZUgwYEamcMZmbSsyv-rGdpn2amkKZwmYNkDmb1v8ffzWFIGx1Szq38dcCiYgFMfiZKHUB1TsGO3Y0pCcb9wAtkH+cBcIZBdSbdD+YBfIConGZBwzkuZrOGQHLhlJ0mcuYUGubunkszBDr1rlGIFJBMKGcUBbuEiSLQY3P2fecCYkiSFpbEBgD4CJZwZ7jWtJasMKEQHUDQf8YSBZbZY5Zr0EVWbkpWa9goqzPQtkfniujUhUlRbokurHXIurJZCoprG5EYCBwhlEAgDEG1D1bVgx0NfEA0NNZYH1YtdMExdrIgDNYNepRtbtYGhAjAndfNYGnhkYDmAKHIj7nLOICIaUbeAeVuD1LYEKBRFOixpiBuAMJPX2j+pRE7F0QkR9E7VTcNlTBKg3VWhkxCy+SdDzMIjbuVt1Vxk0YUj7m-zOCwTQGTheGKwUgmXYA+SXleAJPvJ+1CzoWgCcDDDOmHdHZsDuAzK5xHZ9BsCYOjRsAeW4Qm07Y+SHxxxJYHY03VLGNnxsEgjUR6NMbXY3az23bC3HbnZ7eKxifgVPecD-QvaHe8Qnf1cNLwDoVoM53axOEKApTgGkknsuNMb7kKRUAMII3RgMC6QXjy1SzXZOE3ZqefZSmHZnYnfQ6vdsHnliG0Gqb9jXe5GQ79g5w6SazKWiTUX5jI9kWA9t1MZMViC7eI89zlFo-CS62AxUWo51PfQ6Xo8uNS2RZA-0PhjmDpwLyLjsHcGcSNYkAUMaYzhqC8FHaGG3iuWQ6UBqAzA01w-w7vablJdeps0VzWFMA2E5DHkY9WB7G4Ek8dHbi1xQbzvTpiTDmycE6ERs9oF4Ac9DjY4wvc6RPqIyb4WE++b3f86c4wX5RfWi5I+LjeDCzi4I+LxagS5SgZwMzFjXcYG3rhgMxTuarAEK-SbkCXkiu0E5DrmvFvBBcI4y+KAC9CaIaB1y6mi7fy5IhcAYDDEqipSm2K+mSSba4xxxhs5MToEy7AHVSDTkDy8QYW7lWG-5n5SDWOdfhtxE7r2zs4Yh0eoJYEZLpZTLrzVxmbF-YpD4A49A3ug47FjzaTxzCe4+Vxb3Av3gC4DNRGa3i4BfXmqBXwNBSSJgGeZbvWb0hccU4IDEGBiVsXxiD-Th45m2gVqWexI7Ku+EngIUXumGM-bNQB7khe+ycB8x94Gx7420fzrEYg20b0x-tBSEJJLNASNVWJ6gY5lmvR4-L24lKJKB-jT6e1RldOHJ5c9IFMt+7lBtRClZ-iL4DgtMt4QVEDYRcdH4kGm6GoD6iaFmbAfumtj+5RCDhZqHiXgwvYdl6aC-skKbvW7WiVVcDm4Pj9inJ++Iq9R14ELaaypOiIEHBDE9qO5YLK+GqPROcbpZQ+TK9jSUYYGy+XCp1MED-D+uPeCboVZuCJQJTp3nkoyp2z4j7SpIuj5RWIC8Hj47sG7KGT-0KzmDiVACkr+Em0el9L5zvk5dXQD4DUVuS8LVBIELZ9BLFD8GUfWNeYAoDlW-Y6XRg88H9Eu1DAB1BciAA" class="external-link">Open
in Shinylive</a></p>
<iframe src="https://shinylive.io/r/app/#code=NobwRAdghgtgpmAXGKAHVA6ASmANGAYwHsIAXOMpMAdzgCMAnRRASwgGdSoAbbgCgDk7ABZsAnpyjkBuAAQM4qIu1kBeWQUHDSpVO0QB6AwyUATAlE4YGAWgCuEFgDc4DdnAym4TmbIHbdfSMFJWsbaksYDCIGAHMBAEoEgB0IAGIBWQBRJx47KThZKAhZOAAPVAV2dhYSWTYi2QAzKuFSiCcWBhJ4MlSM-syAGRYAa0LvHgB9UhZTMTk6O1JZahZSNtMWJqbXChWvJqg7blJ2DFkAITFZQ+PTuTZOOChTWSIm+QdHCFjB+pKG0KFl4riE7U63QgvVIjxWDAcKgaUGarQhXR6+ww-wAAuUlAxSKlJtwpgRuC8SgAeGzNBwEWYkPj4hhyChONSybgsTh8BJsiDk5Sc8mUqbsvkJWQgVKyUq5UmzebMiqsiECoXsFIQAC+qX+AGEFAVGqLiuioTDBobjeQVCiIHBqBbMWRVsJlIVUFAFG6ebIgbJYtwiHQeC7oVjcfiYkTBRTiuKOrIaXTBYyIHzpbLZI7qBgJd7fSt1MHQzwJUlUnqIP8AFJEBog7hIshERqoFioODcx3E1VTTvd3uFVNNekZvgYadyDDczic+ekKfTpLZkqlVUqVNznlxuXbWR8Cm-DYqypatTqAAMUplG7lClIdgYmYAcgBVIZDbVyms5llt1pBhuGKWJmCaUCdAoc83G1ACtxTWkADEWFOVw+DfOBYgKPgeQwCATm4flNwveCN0PY8KFiM9AKlVQbzvHNHzgZ9X0wr8fxzf8NywOBTDsAg4D4Zi0wZWpM3gGAiDZVUmIfOVSIYPgAEIVKk9sAFIAD5NNkNSWV-RSdVwUSuDQ2D2DkGwAEZ+VEwDgGAGyAF0XJzbUeJaFgKFMbgxBmFh4CQsTJ1IeS5RWVNugcUwplMXDYVkZIwHcYgIFMdgUqMiAiGdaKiFi+LcIAZQkDBZngPk5BStKSEy7L9Q3KA6HYYqAq2HYQpa9g+ASsQ+Fy6gpVpfq+HCoyoFiUdaSG2RaTjHMeqmKaZqKVq+FWozxzYtbVv09RltWnMtgYELth7dw+B2l84BqsAWiIGBczylL7qmohGtrDcmhiGApCmBRuBC8d0wkvgal+E4fTkVBuBfcN1G9Z5rwhthYmhtVauyiLFLKbrzjYchpuUmKMvGoK4CmE8aOETbWpW6a5EhjHQIYJIjLldhKiJpoRLATS3k0lRhbe2QykeXYW2E-GGNkGzmfRzHYfhhgeBI06jJ4g8pau0Sjumq9ZDqjLetvUyFJSt9XrwUSLulkSFLlA3R1kGA2GWOBersi3FMU36GH+0hAZ7fmTdMbLfb9+pdeE0S-ZdlNZA9F9vfsp3-b+gGgf593CPISP48U+29YzhOGf2qlk8Ktw+AANnT6Po4DoOQ-4FKU4YQuy8UtJZCGL2VA2c0ACYABZq9TuRijeASGHRgNhEKdhYGBCsMp9W4oDEIu-ZLuOe-LtrK63iQ+Ds2QADJ1ra-r4u2T45evKOm79zgGCaSrhKSlLNIASUQJpAAsoAkqshNKoG7q-aO+9HbQKbonKu-VeoAGZG7wLfqQD+X9xr3U0iif+gCQGaTARAqBGDFLv0-pTXByUBYAE0DCaRgEwoWADgGgPAZAsAnN4G8KbvwxSgjeFGU8qkOgRAiCjH+gwUYUxpIJVJCvFwUw7AsBBhOcGcxcYcBCm+EqeFTDkUilNEYvJ9biRICMCAoxBq9Vqh6agUxlFUwUTwSOdCSpQBcMbQeEkvpyjEd9CRUiZFyLcaSEMrxVHqLHJopk2j1xyl0amfRhjjEBlMXuOBikoCWIgNY2xHAw6OOpkQaJESPEpT4pwGIy8-EkACbIIJ4jJHSJ9HIqJcU1EaLBgkoxSTcxAVkGk7ROYuCxDMcuUSaiADyyxUDLDsWHbx-FnENI4DjDy1YmohPabI+RRA3hxL6ZmNgiykqFV0MsZmGzmakBiFtQZKTaTuGqBJAAJJsjcbyagkHip8aKLxxIuD4PeTBjzpofOmsHX5ElepawyVci5HyXFxThSQNqcM8lwA9NwLwZ0gUZVcB+P+YLRIABEAAqzAEpcCpS1Ck8zrnLgxRAL59jUqrPRRstqXA6AUi2RuHUSKFnLFRdy9Z7zMUzEZWtalzBfQEopVIKADKBXCXBYpBQABHCGGyAWSkpTSxAdLVUapyW-A1pg+boL9l7Cw3ZOTIQAIJDBKlkF+lCexwHyZyWq6NBVgFEoipqXMDUEA9CwISIVjQgs1aJXV+rpUQENVWBSSbznirRVKv5HBZUasBnlNq7gKQMn4rw2JtIs2kAlS4HlKa+VyqLdQEtPry0RwUi+YGqY2VpuACwe63aUruQzaxF8mZu2hu+nKUM7gGAuByPsPCEAUVVAeQoOQWqWJ6r7ZGxsQkjUKVqWrKF666nJrzWSKNh701-gySIcQzB3CkEuG0sJWQyjkjsF4PgmhRIOLys41ZhzFFvQA6lUpXTQPuNtpbLlKjoDwHA-BlxKG-a1QjTeuA6HFIpXPQoFKHkkWtVcIulwZAV0opEEB6DESt2iRo9QIBRyeB8AiRSlgPAiCxEtZQlgAAvQo6gUplG4Lh+1lgxAGhDO4TkVKsAfk9UXWYpAKT+rADUjd9SU0SczkQcgZ11ATKmXxv2ETLjLAeZmFKBpihCXEzwr1Cd8mWZ0EyNlHL+YEZw05uhWm6li3JJYFQImwB0FIBAGwPMZE7x4UXO1ikTPZN3rIOZYrWUbK87VSVbKsWgSEniglQqBEhunTmOdZG4BLsozW1FpSXEwe4Ax49jiWOKPY6x7gnHuO8aLi8dg0nZPCdkAppTzmAzlFIH-VdSzPPFJy4h1eVSwAAHFnCFA2P6NljQkO+cS3KX6BnXCcmS+YnuFmrNMls-Zns5CEGuau5mebnK0N+ZSl4lwQXQLVA0xFqLMWfRxeEWV7iJH53keXXVlxjxYi5QUDN9Y8nFOesGZFBg0mpCRrM2jmBnxVI8ipQiDYA1ocgb22ubdr9amoH5gABQTHJ7mvrtg3BRHssJuZlvxZ7jqUo0tcdNwUNJFw7W2OCIhaeuAqLoB6A9NMw+3qU3yNYq8VVi4UuK7fuT1enIydLfgBN6BX9JAwFQJyMq5wcES+jjbwJqWuaOOtrMJo0apDgwd3hsAJUNnG0EkJao45eA3DRURxXNuaxNxMv1hg3QjOhXBnAXGTcmPO+2G7ycnv0pbAzEAweq1mQHejqQMQTqwuuDj2H6BgjI9CLBzsiArv0IMBib0-J6TnnDNGUYsNmTJma79lsJwhjOQLYemhQzZISDmUdF3HhiW8kZjc9Z5ZgGnFN8n1sXrUx-srZdaYN4G-XBNJaY3ifrhQNt8nDWuQyKbm+JTXIM14o5Kd5Ci93vL632hI6Z+79v7-1IMgMj8W8t8QxYgd9IsxYUpXg4oQDIDax59e94DXcexMoQolw+Qcx-pxg+JF8NtLg2Athfh+YUCfJ8UsoecKsIBv99lbFQZ29JByBk9jYuByAPkFQ7AvYPkyC0Cpg9thkBDrpz8W9UCKDysNwSAAsFBrp4lns2Ck9cdeD8V+DV5hkmDpdODuDlC4oBDRIA4jwxDTA9sARmgRCpgjDVD4BLwqdnYD9UJm9hC0CKdRJa8RVe9KsF1qsKNlxodSl4CwCeMECWsE5cg0Jm0jDBC1DmQFQyQExMxn8WRJQpQdJNIi4wx3Bn1WJOo+YhCdCtQMlHc8oxd+AOMuNwCcdVN1Mwt99D8RCUMi41YtgiBl9MVV9x9m8LDyCI53swBUI0CAx2wQCxZvEoBwjC1Ij04i4jtDNTsslztoFLt3MbMwA7NBQ7snNUt8CSBWjMwx9YCujOjd9ejaizDm8mk-YREJDZ1SMvCatfDZta0Dj4D-sQjcl7CRCqNxUdDeFhciBRcussDhUMlYCHDZiTl28jCKdcc5gQpkZyBUYUp4CpgxYoTV5CizjwTaQCBbQ4AwSMIi4zVOQSQ4jKQ+pVUX9KhJQnI0T4A3IJtYT1BiltEJtaSRs2SQ1e9DsFA4AhM8D40AA1PIYSG-eoHvGdYuDgVwUgUlHHeEuAREsANIMWMfeA9KGfY-efCbFKOgOAAOarDKPTOUPuKlWZClWZRAUodgR1ZebsAgcojQYQH0RfVwVsMw5w5bDOEAj5NRTkiUw7EQj5GtP+Y5atTtP2fImk7ovbNyFMMceo4VXvONWYUFKnKoE4YOFkEKRI1UIEu2fHGmM8fI+iRiQXeQcddidM04Sk9mVwrk2QPuVbKQJeM6Owc3HgYGEApSXlByRCVMUCdAfyQaaI4suQBgycaE2wzEk7eMzoyIpyGM0dJufGVMSwDAQbGACRfgaEtIG1Bc1eNyIuIsWAc6R4qM5vJyFKYMnotyQ8jObPGskGEQy8jowzT9SoEdFyPgWWcWWGZ056JGf8wRSiFSfCQiXgP9eqGsynVLKszM1UOM2kJItSOCx81I6c5SNSB8wyGvIuNgToGoC1Xhdw-08s9gDMms+vXUJqHEl4cgfEwlWkcc8GM1R4UwMc6M9EwZD8dwPPDYI5fmWigoBir6HiIS+ikQjASNZ08tRihPJkVisUjij0+AXGTAmZdRYzKbGbC5QxZS-FPbe6e7DC98+PZipkCWWQY8mAFgnWI8FSCAATaS5SaymCnuT8b8IuPnS6QoKcuUJI2IEIfgNSayuQNSSylgOHOpKSywEbMbVHV3MofiZHJTO9aOWvP8bZai76cSvEySwieAeeAgK-Fi1VNi-S4wrirVdSrtTS42bkAlHSpZPC9i6Yziw3IuPOTkPOckrgIvf6H8ga3qqAIvLQzkNWX4YSM1ERL1EA0yzkcyzMSy1yss5ClSfGbSdQEK-85yFyK+fSdalMLalSay4AEeFyYirKsS3EhijAImbCGc7Em6-KuwQq6NGi565vDAI4BkGIEqhSsqpS90gyqqnMGtA0afboHtatAs6iM8CkFwFsYatcbSWQBuXHUtX1abR4vS4Gyqw3LkbwS6ZGuQZyl05Sc2N2DMrsao0bFHLWfnOTKnSNX1UYCRMoVbGKVAJq3w9ivGwywmxG3qaarWXvGqv2HpdQcGyGogZrfQkQ+a9QRa78v8tWGyssyiQsumFap+WyxSDyoYLyxm3y1LNa-GTSNgPSbatW3ChSWvU-XK26unWZEqP+AADSiieroryq+oKtcHeqlLLWDlyDcFbwhOvwGS1ReRGQMTGQ3DOwVwlpYGZV0rHxDral9KQI3FP0xoZCmHTv+rOUeNvwy1uUf1kHTqfwpMMjf17Sy2+Qqwyw4J9AzqrXLOJQYFlKpxaDgF5LgH5JTLgCFPhhFOLroXTouN8SDp5vaInt6KFPnjlSHnbC2G5lAjizkHTuqiptOBprivptEjSBZoIDZqIA5q5pnrTpbpWwXq4w1UoLkCEOmtuSDuSqZOiJFqopzGTI23JQUk1rhrpjq3TpLNkFvDLJzKpOIuNtWtzLUkgeUhSN0inqxtUjUg3N6mAZbo5jrOBIb1SHIpgBkUEyph6XDq0UjpzGju7yMgTr43SxZXaMIeIaExiRK2aXwY4FepYdcSOULq+MuVLofzzU3pbqrq4GgsGTv1rWYZ9BIbDuAl8hJTJSp2jo-1IroaLlzuxt0tSzH0CsKlQB32ByNzoU5sMdkDoA3tS33WjS9k5C3qLzlBgGprhn3qUwSwm20Znr0c5SIG7DVgzGMow2924aB3eACfd0aTg2gUAPgGKGgNSlesSeIAcCJB5wES8fbR0eap7n2NiECuwgKGCa9xKjCYxwruFKNMUlsYDwcZbuqlSxcd3rcZSqyASz9PvSTOBUHr-r9lQqzNTAQaBL3lhtPCAceOhS5uMalFRvAanIGYQtTDWsWcqHAWQYMbbOMbQZUgwYEamcMZmbSsyv-rGdpn2amkKZwmYNkDmb1v8ffzWFIGx1Szq38dcCiYgFMfiZKHUB1TsGO3Y0pCcb9wAtkH+cBcIZBdSbdD+YBfIConGZBwzkuZrOGQHLhlJ0mcuYUGubunkszBDr1rlGIFJBMKGcUBbuEiSLQY3P2fecCYkiSFpbEBgD4CJZwZ7jWtJasMKEQHUDQf8YSBZbZY5Zr0EVWbkpWa9goqzPQtkfniujUhUlRbokurHXIurJZCoprG5EYCBwhlEAgDEG1D1bVgx0NfEA0NNZYH1YtdMExdrIgDNYNepRtbtYGhAjAndfNYGnhkYDmAKHIj7nLOICIaUbeAeVuD1LYEKBRFOixpiBuAMJPX2j+pRE7F0QkR9E7VTcNlTBKg3VWhkxCy+SdDzMIjbuVt1Vxk0YUj7m-zOCwTQGTheGKwUgmXYA+SXleAJPvJ+1CzoWgCcDDDOmHdHZsDuAzK5xHZ9BsCYOjRsAeW4Qm07Y+SHxxxJYHY03VLGNnxsEgjUR6NMbXY3az23bC3HbnZ7eKxifgVPecD-QvaHe8Qnf1cNLwDoVoM53axOEKApTgGkknsuNMb7kKRUAMII3RgMC6QXjy1SzXZOE3ZqefZSmHZnYnfQ6vdsHnliG0Gqb9jXe5GQ79g5w6SazKWiTUX5jI9kWA9t1MZMViC7eI89zlFo-CS62AxUWo51PfQ6Xo8uNS2RZA-0PhjmDpwLyLjsHcGcSNYkAUMaYzhqC8FHaGG3iuWQ6UBqAzA01w-w7vablJdeps0VzWFMA2E5DHkY9WB7G4Ek8dHbi1xQbzvTpiTDmycE6ERs9oF4Ac9DjY4wvc6RPqIyb4WE++b3f86c4wX5RfWi5I+LjeDCzi4I+LxagS5SgZwMzFjXcYG3rhgMxTuarAEK-SbkCXkiu0E5DrmvFvBBcI4y+KAC9CaIaB1y6mi7fy5IhcAYDDEqipSm2K+mSSba4xxxhs5MToEy7AHVSDTkDy8QYW7lWG-5n5SDWOdfhtxE7r2zs4Yh0eoJYEZLpZTLrzVxmbF-YpD4A49A3ug47FjzaTxzCe4+Vxb3Av3gC4DNRGa3i4BfXmqBXwNBSSJgGeZbvWb0hccU4IDEGBiVsXxiD-Th45m2gVqWexI7Ku+EngIUXumGM-bNQB7khe+ycB8x94Gx7420fzrEYg20b0x-tBSEJJLNASNVWJ6gY5lmvR4-L24lKJKB-jT6e1RldOHJ5c9IFMt+7lBtRClZ-iL4DgtMt4QVEDYRcdH4kGm6GoD6iaFmbAfumtj+5RCDhZqHiXgwvYdl6aC-skKbvW7WiVVcDm4Pj9inJ++Iq9R14ELaaypOiIEHBDE9qO5YLK+GqPROcbpZQ+TK9jSUYYGy+XCp1MED-D+uPeCboVZuCJQJTp3nkoyp2z4j7SpIuj5RWIC8Hj47sG7KGT-0KzmDiVACkr+Em0el9L5zvk5dXQD4DUVuS8LVBIELZ9BLFD8GUfWNeYAoDlW-Y6XRg88H9Eu1DAB1BciAA" width="150%" height="800px" data-external="1" style="position: relative; z-index:1">
</iframe>
</div>
<div class="section level2">
<h2 id="application-code">Application Code<a class="anchor" aria-label="anchor" href="#application-code"></a>
</h2>
<p>The remainder of this vignette contains the source code of the
application. Note that the version included in the package is
constructed with separate R scripts containing the module and utility
function code.</p>
<p>The same principles for using <code>shinystate</code> in an
application apply in this example as well, but here are specific notes
for the implementation used in this example application:</p>
<ul>
<li>The module <code>bookmark_mod</code> contains a parameter for the
<code>StorageClass</code> instance used for the application.</li>
<li>Bookmarkable state sessions are displayed using an interactive table
produced by <code><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">DT::datatable()</a></code> with the ability to select the
row used to restore a saved session. This is just one approach to
display sessions in a Shiny application.</li>
<li>A reactive object <code>session_choice</code> corresponding to the
<code>url</code> value of the selected row in the sessions table is
supplied to the <code>restore()</code> method of the
<code>StorageClass</code> instance.</li>
<li>Additional information corresponding to the session name entered in
a text input as well as the current time are saved as part of the
bookmarkable state snapshot metadata, assembled as a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>
object with named elements for each variable.</li>
</ul>
<div class="section level3">
<h3 id="app-r">
<code>app.R</code><a class="anchor" aria-label="anchor" href="#app-r"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpodcast.github.io/shinystate/">shinystate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rlang.r-lib.org" class="external-link">rlang</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  recommended to define a directory for storage or a pins board</span></span>
<span><span class="va">storage</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/StorageClass.html">StorageClass</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">req</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="co"># Bootstrap header</span></span>
<span>    <span class="va">tags</span><span class="op">$</span><span class="fu">header</span><span class="op">(</span></span>
<span>      class <span class="op">=</span> <span class="st">"navbar navbar-default navbar-static-top"</span>,</span>
<span>      <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span></span>
<span>        class <span class="op">=</span> <span class="st">"container-fluid"</span>,</span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span></span>
<span>          class <span class="op">=</span> <span class="st">"navbar-header"</span>,</span>
<span>          <span class="va">tags</span><span class="op">$</span><span class="fu">div</span><span class="op">(</span>class <span class="op">=</span> <span class="st">"navbar-brand"</span>, <span class="st">"Bookmark Module Demo"</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="co"># Links for restoring/loading sessions</span></span>
<span>        <span class="va">tags</span><span class="op">$</span><span class="fu">ul</span><span class="op">(</span></span>
<span>          class <span class="op">=</span> <span class="st">"nav navbar-nav navbar-right"</span>,</span>
<span>          <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span></span>
<span>            <span class="fu">bookmark_modal_load_ui</span><span class="op">(</span><span class="st">"bookmark"</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>          <span class="va">tags</span><span class="op">$</span><span class="fu">li</span><span class="op">(</span></span>
<span>            <span class="fu">bookmark_modal_save_ui</span><span class="op">(</span><span class="st">"bookmark"</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/use_shinystate.html">use_shinystate</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarLayout</a></span><span class="op">(</span></span>
<span>        position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/column.html" class="external-link">column</a></span><span class="op">(</span></span>
<span>          width <span class="op">=</span> <span class="fl">4</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/wellPanel.html" class="external-link">wellPanel</a></span><span class="op">(</span></span>
<span>            <span class="fu">select_vars_ui</span><span class="op">(</span><span class="st">"select"</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/wellPanel.html" class="external-link">wellPanel</a></span><span class="op">(</span></span>
<span>            <span class="fu">filter_ui</span><span class="op">(</span><span class="st">"filter"</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">mainPanel</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabsetPanel.html" class="external-link">tabsetPanel</a></span><span class="op">(</span></span>
<span>            id <span class="op">=</span> <span class="st">"tabs"</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html" class="external-link">tabPanel</a></span><span class="op">(</span><span class="st">"Plot"</span>, <span class="va">tags</span><span class="op">$</span><span class="fu">br</span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html" class="external-link">plotOutput</a></span><span class="op">(</span><span class="st">"plot"</span>, height <span class="op">=</span> <span class="fl">600</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html" class="external-link">tabPanel</a></span><span class="op">(</span><span class="st">"Summary"</span>, <span class="va">tags</span><span class="op">$</span><span class="fu">br</span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="st">"summary"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/tabPanel.html" class="external-link">tabPanel</a></span><span class="op">(</span><span class="st">"Table"</span>, <span class="va">tags</span><span class="op">$</span><span class="fu">br</span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html" class="external-link">tableOutput</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html" class="external-link">callModule</a></span><span class="op">(</span><span class="va">bookmark_mod</span>, <span class="st">"bookmark"</span>, <span class="va">storage</span><span class="op">)</span></span>
<span>  <span class="va">storage</span><span class="op">$</span><span class="fu">register_metadata</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">datasetExpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">mutate</span><span class="op">(</span>cyl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">filterExpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html" class="external-link">callModule</a></span><span class="op">(</span><span class="va">filter_mod</span>, <span class="st">"filter"</span>, <span class="va">datasetExpr</span><span class="op">)</span></span>
<span>  <span class="va">selectExpr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html" class="external-link">callModule</a></span><span class="op">(</span></span>
<span>    <span class="va">select_vars</span>,</span>
<span>    <span class="st">"select"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">eval_clean</span><span class="op">(</span><span class="fu">datasetExpr</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va">filterExpr</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">resultExpr</span> <span class="op">&lt;-</span> <span class="fu">selectExpr</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">eval_clean</span><span class="op">(</span><span class="va">resultExpr</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html" class="external-link">validate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/validate.html" class="external-link">need</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"No data matches the filter"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">df</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderTable.html" class="external-link">renderTable</a></span><span class="op">(</span></span>
<span>    <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    rownames <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">do_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html" class="external-link">renderPlot</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">do_plot</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderPrint</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">format_tidy_code</span><span class="op">(</span><span class="fu">selectExpr</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span>, onStart <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/enableBookmarking.html" class="external-link">enableBookmarking</a></span><span class="op">(</span><span class="st">"server"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bookmark_modules-r">
<code>bookmark_modules.R</code><a class="anchor" aria-label="anchor" href="#bookmark_modules-r"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bookmark_modal_save_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionLink</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"show_save_modal"</span><span class="op">)</span>, <span class="st">"Save session"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bookmark_modal_load_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionLink</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"show_load_modal"</span><span class="op">)</span>, <span class="st">"Restore session"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bookmark_load_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html" class="external-link">uiOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"saved_sessions"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bookmark_mod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">storage</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="va">session</span><span class="op">$</span><span class="va">ns</span></span>
<span>  <span class="va">session_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">storage</span><span class="op">$</span><span class="fu">get_sessions</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">saved_sessions_placeholder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html" class="external-link">renderUI</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html" class="external-link">dataTableOutput</a></span><span class="op">(</span><span class="va">session</span><span class="op">$</span><span class="fu">ns</span><span class="op">(</span><span class="st">"saved_sessions_table"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">saved_sessions_table</span> <span class="op">&lt;-</span> <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html" class="external-link">renderDataTable</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">session_df</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span></span>
<span>      <span class="fu">session_df</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      escape <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      selection <span class="op">=</span> <span class="st">"single"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">session_choice</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">session_df</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">saved_sessions_table_rows_selected</span><span class="op">)</span></span>
<span>    <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">input</span><span class="op">$</span><span class="va">saved_sessions_table_rows_selected</span></span>
<span>    <span class="va">url</span> <span class="op">&lt;-</span> <span class="fu">session_df</span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="va">i</span>, <span class="st">"url"</span><span class="op">]</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">restore</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html" class="external-link">req</a></span><span class="op">(</span><span class="fu">session_choice</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">storage</span><span class="op">$</span><span class="fu">restore</span><span class="op">(</span><span class="fu">session_choice</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/setBookmarkExclude.html" class="external-link">setBookmarkExclude</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"show_save_modal"</span>,</span>
<span>    <span class="st">"show_load_modal"</span>,</span>
<span>    <span class="st">"save_name"</span>,</span>
<span>    <span class="st">"save"</span>,</span>
<span>    <span class="st">"session_choice"</span>,</span>
<span>    <span class="st">"restore"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_load_modal</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showModal.html" class="external-link">showModal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalDialog</a></span><span class="op">(</span></span>
<span>      size <span class="op">=</span> <span class="st">"xl"</span>,</span>
<span>      easyClose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Restore session"</span>,</span>
<span>      footer <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalButton</a></span><span class="op">(</span><span class="st">"Cancel"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="va">session</span><span class="op">$</span><span class="fu">ns</span><span class="op">(</span><span class="st">"restore"</span><span class="op">)</span>, <span class="st">"Restore"</span>, class <span class="op">=</span> <span class="st">"btn-primary"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html" class="external-link">uiOutput</a></span><span class="op">(</span><span class="va">session</span><span class="op">$</span><span class="fu">ns</span><span class="op">(</span><span class="st">"saved_sessions_placeholder"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_save_modal</span>, <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showModal.html" class="external-link">showModal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalDialog</a></span><span class="op">(</span></span>
<span>      easyClose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="va">session</span><span class="op">$</span><span class="fu">ns</span><span class="op">(</span><span class="st">"save_name"</span><span class="op">)</span>, <span class="st">"Give this session a name"</span><span class="op">)</span>,</span>
<span>      footer <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalButton</a></span><span class="op">(</span><span class="st">"Cancel"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="va">session</span><span class="op">$</span><span class="fu">ns</span><span class="op">(</span><span class="st">"save"</span><span class="op">)</span>, <span class="st">"Save"</span>, class <span class="op">=</span> <span class="st">"btn-primary"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">save</span>, ignoreInit <span class="op">=</span> <span class="cn">TRUE</span>, <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/isTruthy.html" class="external-link">isTruthy</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">save_name</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Please specify a bookmark name"</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showModal.html" class="external-link">removeModal</a></span><span class="op">(</span><span class="op">)</span></span>
<span>          <span class="va">storage</span><span class="op">$</span><span class="fu">snapshot</span><span class="op">(</span></span>
<span>            session_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>              save_name <span class="op">=</span> <span class="va">input</span><span class="op">$</span><span class="va">save_name</span>,</span>
<span>              timestamp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showNotification.html" class="external-link">showNotification</a></span><span class="op">(</span></span>
<span>            <span class="st">"Session successfully saved"</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showNotification.html" class="external-link">showNotification</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">conditionMessage</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span>,</span>
<span>          type <span class="op">=</span> <span class="st">"error"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="filter_module-r">
<code>filter_module.R</code><a class="anchor" aria-label="anchor" href="#filter_module-r"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filter_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">div</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu">ns</span><span class="op">(</span><span class="st">"filter_container"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"show_filter_dialog_btn"</span><span class="op">)</span>, <span class="st">"Add filter"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">filter_mod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">data_expr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="va">session</span><span class="op">$</span><span class="va">ns</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/setBookmarkExclude.html" class="external-link">setBookmarkExclude</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"show_filter_dialog_btn"</span>, <span class="st">"add_filter_btn"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">filter_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/makeReactiveBinding.html" class="external-link">makeReactiveBinding</a></span><span class="op">(</span><span class="st">"filter_fields"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/onBookmark.html" class="external-link">onBookmark</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">state</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">filter_field_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">filter_fields</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/onBookmark.html" class="external-link">onRestore</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">filter_field_names</span> <span class="op">&lt;-</span> <span class="va">state</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">filter_field_names</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">fieldname</span> <span class="kw">in</span> <span class="va">filter_field_names</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">addFilter</span><span class="op">(</span><span class="va">fieldname</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">show_filter_dialog_btn</span>, <span class="op">{</span></span>
<span>    <span class="va">available_fields</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">eval_clean</span><span class="op">(</span><span class="fu">data_expr</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">filter_fields</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showModal.html" class="external-link">showModal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalDialog</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"Add filter"</span>,</span>
<span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/radioButtons.html" class="external-link">radioButtons</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"filter_field"</span><span class="op">)</span>, <span class="st">"Field to filter"</span>, <span class="va">available_fields</span><span class="op">)</span>,</span>
<span></span>
<span>      footer <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/modalDialog.html" class="external-link">modalButton</a></span><span class="op">(</span><span class="st">"Cancel"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html" class="external-link">actionButton</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"add_filter_btn"</span><span class="op">)</span>, <span class="st">"Add filter"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">observeEvent</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">add_filter_btn</span>, <span class="op">{</span></span>
<span>    <span class="fu">addFilter</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">filter_field</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/showModal.html" class="external-link">removeModal</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">addFilter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fieldname</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"filter__"</span>, <span class="va">fieldname</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu">createFilter</span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="fu">eval_clean</span><span class="op">(</span><span class="fu">data_expr</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="va">fieldname</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      id <span class="op">=</span> <span class="fu">ns</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span>      fieldname <span class="op">=</span> <span class="va">fieldname</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/freezeReactiveValue.html" class="external-link">freezeReactiveValue</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/insertUI.html" class="external-link">insertUI</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"#"</span>, <span class="fu">ns</span><span class="op">(</span><span class="st">"filter_container"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="st">"beforeEnd"</span>,</span>
<span>      <span class="co"># TODO: escape special characters in fieldname</span></span>
<span>      <span class="va">filter</span><span class="op">$</span><span class="va">ui</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="va">filter</span><span class="op">$</span><span class="va">inputId</span> <span class="op">&lt;-</span> <span class="va">id</span></span>
<span>    <span class="va">filter_fields</span><span class="op">[[</span><span class="va">fieldname</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="va">filter</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">result_expr</span> <span class="op">&lt;-</span> <span class="fu">data_expr</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">filter_fields</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result_expr</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Gather up all filter expressions</span></span>
<span>    <span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">filter_fields</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">filter</span> <span class="op">&lt;-</span> <span class="va">filter_fields</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/name.html" class="external-link">as.symbol</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="co">#df[[name]]</span></span>
<span>      <span class="va">param</span> <span class="op">&lt;-</span> <span class="va">input</span><span class="op">[[</span><span class="va">filter</span><span class="op">[[</span><span class="st">"inputId"</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">cond_expr</span> <span class="op">&lt;-</span> <span class="va">filter</span><span class="op">[[</span><span class="st">"filterExpr"</span><span class="op">]</span><span class="op">]</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, param <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">cond_expr</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">result_expr</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">result_expr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">cond_expr</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">result_expr</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">createFilter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">id</span>, <span class="va">fieldname</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">UseMethod</a></span><span class="op">(</span><span class="st">"createFilter"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">createFilter.character</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">id</span>, <span class="va">fieldname</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ui <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textInput.html" class="external-link">textInput</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">fieldname</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>    filterExpr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nzchar</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">param</span>, <span class="op">!</span><span class="op">!</span><span class="va">x</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">createFilter.numeric</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">id</span>, <span class="va">fieldname</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ui <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html" class="external-link">sliderInput</a></span><span class="op">(</span></span>
<span>      <span class="va">id</span>,</span>
<span>      <span class="va">fieldname</span>,</span>
<span>      min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>      max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>      value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    filterExpr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">x</span> <span class="op">&gt;=</span> <span class="op">!</span><span class="op">!</span><span class="va">param</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">!</span><span class="va">x</span> <span class="op">&lt;=</span> <span class="op">!</span><span class="op">!</span><span class="va">param</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">createFilter.integer</span> <span class="op">&lt;-</span> <span class="va">createFilter.numeric</span></span>
<span></span>
<span><span class="va">createFilter.factor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">id</span>, <span class="va">fieldname</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">inputControl</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">fieldname</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, multiple <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/checkboxGroupInput.html" class="external-link">checkboxGroupInput</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">fieldname</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    ui <span class="op">=</span> <span class="va">inputControl</span>,</span>
<span>    filterExpr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">param</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="cn">NULL</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="op">!</span><span class="op">!</span><span class="va">param</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">createFilter.POSIXt</span> <span class="op">&lt;-</span> <span class="va">createFilter.numeric</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="select_module-r">
<code>select_module.R</code><a class="anchor" aria-label="anchor" href="#select_module-r"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">select_vars_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html" class="external-link">uiOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"vars_ui"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">select_vars</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">vars</span>, <span class="va">data_expr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="va">session</span><span class="op">$</span><span class="va">ns</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">vars_ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html" class="external-link">renderUI</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/freezeReactiveValue.html" class="external-link">freezeReactiveValue</a></span><span class="op">(</span><span class="va">input</span>, <span class="st">"vars"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"vars"</span><span class="op">)</span>, <span class="st">"Variables to display"</span>, <span class="fu">vars</span><span class="op">(</span><span class="op">)</span>, multiple <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co">#checkboxGroupInput(ns("vars"), "Variables", names(data), selected = names(data))</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">vars</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">data_expr</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu">data_expr</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">select</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">syms</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarize_module-r">
<code>summarize_module.R</code><a class="anchor" aria-label="anchor" href="#summarize_module-r"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summarize_ui</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html" class="external-link">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html" class="external-link">uiOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"summarize_ui"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">summarize_mod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">vars</span>, <span class="va">data_expr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">summarize_ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderUI.html" class="external-link">renderUI</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">ns</span> <span class="op">&lt;-</span> <span class="va">session</span><span class="op">$</span><span class="va">ns</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/tagList.html" class="external-link">tagList</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span></span>
<span>        <span class="fu">ns</span><span class="op">(</span><span class="st">"group_by"</span><span class="op">)</span>,</span>
<span>        <span class="st">"Group by"</span>,</span>
<span>        choices <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        multiple <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span></span>
<span>        <span class="fu">ns</span><span class="op">(</span><span class="st">"operation"</span><span class="op">)</span>,</span>
<span>        <span class="st">"Summary operation"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sum"</span>, <span class="st">"count"</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span></span>
<span>        <span class="fu">ns</span><span class="op">(</span><span class="st">"aggregate"</span><span class="op">)</span>,</span>
<span>        <span class="st">"Summary value"</span>,</span>
<span>        choices <span class="op">=</span> <span class="fu">vars</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        multiple <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">result_expr</span> <span class="op">&lt;-</span> <span class="fu">data_expr</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">group_by</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">result_expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">result_expr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">group_by</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">syms</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">group_by</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">aggregate</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">op</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span></span>
<span>        <span class="va">input</span><span class="op">$</span><span class="va">operation</span>,</span>
<span>        mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>        sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">sum</span><span class="op">)</span>,</span>
<span>        count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">agg_exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">aggregate</span>, <span class="kw">function</span><span class="op">(</span><span class="va">var</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">col_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">operation</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">col_name</span> <span class="op">:=</span> <span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">op</span><span class="op">)</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html" class="external-link">sym</a></span><span class="op">(</span><span class="va">var</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span>
<span>      <span class="va">result_expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">result_expr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">summarise</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">agg_exprs</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">result_expr</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="utils-r">
<code>utils.R</code><a class="anchor" aria-label="anchor" href="#utils-r"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Evaluate an expression in a fresh environment</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Like eval_tidy, but with different defaults. By default, instead of running</span></span>
<span><span class="co">#' in the caller's environment, it runs in a fresh environment.</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">eval_clean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">expr</span>, <span class="va">env</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">enclos</span> <span class="op">=</span> <span class="fu">clean_env</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/eval_tidy.html" class="external-link">eval_tidy</a></span><span class="op">(</span><span class="va">expr</span>, <span class="va">env</span>, <span class="va">enclos</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Create a clean environment</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' Creates a new environment whose parent is the global environment.</span></span>
<span><span class="co">#' @export</span></span>
<span><span class="va">clean_env</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Join calls into a pipeline</span></span>
<span><span class="va">expr_pipeline</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">.list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">exprs</span> <span class="op">&lt;-</span> <span class="va">.list</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">exprs</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/flatten.html" class="external-link">flatten</a></span><span class="op">(</span><span class="va">exprs</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">exprs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Negate</a></span><span class="op">(</span><span class="va">is.null</span><span class="op">)</span>, <span class="va">exprs</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">exprs</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">memo</span>, <span class="va">expr</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rlang.r-lib.org/reference/expr.html" class="external-link">expr</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">memo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="op">!</span><span class="op">!</span><span class="va">expr</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">exprs</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="va">exprs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">friendly_time</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">round_date</a></span><span class="op">(</span><span class="va">t</span>, <span class="st">"seconds"</span><span class="op">)</span></span>
<span>  <span class="va">now</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">round_date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"seconds"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">abs_day_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">now</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html" class="external-link">day</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">age</span> <span class="op">&lt;-</span> <span class="va">now</span> <span class="op">-</span> <span class="va">t</span></span>
<span></span>
<span>  <span class="va">abs_age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span>
<span>  <span class="va">future</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">!=</span> <span class="va">abs_age</span></span>
<span>  <span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">future</span>, <span class="st">"from now"</span>, <span class="st">"ago"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">format_rel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">singular</span>, <span class="va">plural</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">singular</span>, <span class="st">"s"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/time_length.html" class="external-link">time_length</a></span><span class="op">(</span><span class="va">abs_age</span>, <span class="va">singular</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%d %s %s"</span>, <span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">singular</span>, <span class="va">plural</span><span class="op">)</span>, <span class="va">dir</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>    <span class="va">abs_age</span> <span class="op">==</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">seconds</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="st">"Now"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>      <span class="va">abs_age</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">minutes</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>      <span class="fu">format_rel</span><span class="op">(</span><span class="st">"second"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>        <span class="va">abs_age</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">hours</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>        <span class="fu">format_rel</span><span class="op">(</span><span class="st">"minute"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>          <span class="va">abs_age</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">hours</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>          <span class="fu">format_rel</span><span class="op">(</span><span class="st">"hour"</span><span class="op">)</span>,</span>
<span>          <span class="co"># Less than 24 hours, and during the same calendar day</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>            <span class="va">abs_age</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">abs_day_diff</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strftime</a></span><span class="op">(</span><span class="va">t</span>, <span class="st">"%I:%M:%S %p"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>              <span class="va">abs_age</span> <span class="op">&lt;</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strftime</a></span><span class="op">(</span><span class="va">t</span>, <span class="st">"%a %I:%M:%S %p"</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strftime</a></span><span class="op">(</span><span class="va">t</span>, <span class="st">"%Y/%m/%d %I:%M:%S %p"</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Nantz, Eli Lilly and Company.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
